<html>
  <head>
  <meta charset="utf-8">
  <meta lang="en">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Doug Skinner</title>
  <link rel="shortcut icon" href="/img/favicon.ico" />

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link href="/static/css/custom.css" rel="stylesheet">

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script src="/static/js/custom.js"></script>

  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-97386400-1', 'auto');
      ga('send', 'pageview');
  </script>
</head>

  <body>
    <nav class="navbar fixed-top navbar-expand-md navbar-light bg-light">
  <a class="navbar-brand" href="/">DS</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav ml-auto text-center">
      <li class="nav-item">
        <a class="nav-link" href="/">Home</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/about.html">About</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/photos.html">Photos</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/projects.html">Projects</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/writings.html">Writings</a>
      </li>
    </ul>
  </div>
</nav>

    <div class="blog_post">
      <h4><a href="">Building a Shell, Part 2</a></h4>
      <hr />
      <p><p>This is the second section in a series of posts walking through the steps I took
to make a basic shell for a final project for a systems programming class. The
only thing that weâ€™ll be adding to the
shell today is probably the most important aspect of the shell, the fact that
all of the actions that it does are run in background processes, and the main or
parent process only is responsible for getting input, passing it to the process,
and then getting whatever the process returns. In C, processes are created
through the <a href="https://linux.die.net/man/2/fork">fork</a> system call, and contain an exact
copy of the parent processes memory. This is unfortunately not the place to go
into in depth detail of processes, and that will occur a different day. For now,
an example that runs the printing of the input in a child process, and gets the
input in a parent process would look like so:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>int main(void) {
    int _continue = 0;
    char *buff = malloc(sizeof(char) * 512);

    do {
        printf("[Command prompt]$ ");
        buff = getLine(stdin); // uses the getLine from yesterdays post.

        char *token;
        token = strtok(buff, " \n");

        if (strcmp(token, "quit") == 0) {
            _continue = -1;
        } else {
            pid_t child, wait;
            int child_status;

            child = fork();

            if (child == 0) {
                puts(buff);
                return 1;
            } else {
                do {
                    wait = waitpid(child, &amp;child_status, WUNTRACED);
                } while (!WIFEXITED(child_status) &amp;&amp; !WIFSIGNALED(child_status));
            }
        }
        free(buff);
    } while (_continue &gt;= 0);

    return 0;
}
</code></pre></div></div>
</p>
      <h5><a href="/writings.html">Archives</a></h5>
    </div>
  </body>
</html>
